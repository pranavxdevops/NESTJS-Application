'use client';
import { cn } from '@/lib/utils/cn';
import { usePathname } from 'next/navigation';
import Link from 'next/link';

interface FooterNavItem {
  label: string;
  icon: React.ReactNode;
  path: string;
  hasNotification?: boolean;
  notificationCount?: number;
}

interface MobileNavigationFooterProps {
  items?: FooterNavItem[];
  className?: string;
}

export default function DashboardFooter({
  items = [],
  className,
}: MobileNavigationFooterProps) {
  const pathname = usePathname();

  // Helper function to check if a nav item is active
  const isActive = (itemPath: string) => {
    // Remove locale prefix from pathname (e.g., /en/events -> /events)
    const pathWithoutLocale = pathname.replace(/^\/(en|fr|es)/, '');
    // Check if current path starts with the item path
    return pathWithoutLocale.startsWith(itemPath);
  };

  const defaultItems: FooterNavItem[] = [
    {
      label: 'Knowledge',
      path: '/knowledge',
      icon: (
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M9 21C8.2 21 7.55556 20.7222 7.06667 20.1667C6.57778 19.6111 6.27778 18.9444 6.2 18.1667C4.93333 17.9889 3.88889 17.4 3.06667 16.4C2.24444 15.4 1.83333 14.2444 1.83333 12.9333C1.83333 12.4889 1.89444 12.0556 2.01667 11.6333C2.13889 11.2111 2.32222 10.8222 2.56667 10.4667C2.32222 10.1111 2.13889 9.72778 2.01667 9.31667C1.89444 8.90556 1.83333 8.46667 1.83333 8C1.83333 6.68889 2.24444 5.53889 3.06667 4.55C3.88889 3.56111 4.92222 2.97778 6.16667 2.8C6.23333 1.96667 6.52778 1.26111 7.05 0.683333C7.57222 0.105556 8.21111 -0.183333 8.96667 -0.183333C9.47778 -0.183333 9.95 -0.0777778 10.3833 0.133333C10.8167 0.344444 11.2111 0.622222 11.5667 0.966667C11.9 0.622222 12.2889 0.344444 12.7333 0.133333C13.1778 -0.0777778 13.6556 -0.183333 14.1667 -0.183333C14.9222 -0.183333 15.5556 0.1 16.0667 0.666667C16.5778 1.23333 16.8667 1.93333 16.9333 2.76667C18.1778 2.94444 19.2167 3.53333 20.05 4.53333C20.8833 5.53333 21.3 6.68889 21.3 8C21.3 8.46667 21.2389 8.90556 21.1167 9.31667C20.9944 9.72778 20.8111 10.1111 20.5667 10.4667C20.8111 10.8222 20.9944 11.2111 21.1167 11.6333C21.2389 12.0556 21.3 12.4889 21.3 12.9333C21.3 14.2667 20.8833 15.4278 20.05 16.4167C19.2167 17.4056 18.1667 17.9889 16.9 18.1667C16.8 18.9444 16.5056 19.6111 16.0167 20.1667C15.5278 20.7222 14.9 21 14.1333 21C13.6444 21 13.1722 20.8944 12.7167 20.6833C12.2611 20.4722 11.8667 20.1889 11.5333 19.8333C11.1778 20.1889 10.7778 20.4722 10.3333 20.6833C9.88889 20.8944 9.42222 21 8.93333 21H9ZM12.8333 3.06667V17.9333C12.8333 18.3778 12.9889 18.7611 13.3 19.0833C13.6111 19.4056 13.9889 19.5667 14.4333 19.5667C14.8556 19.5667 15.2222 19.3944 15.5333 19.05C15.8444 18.7056 15.9889 18.3111 16 17.8667C15.5333 17.6889 15.1056 17.4611 14.7167 17.1833C14.3278 16.9056 13.9778 16.5778 13.6667 16.2C13.4444 15.8889 13.3611 15.5556 13.4167 15.2C13.4722 14.8444 13.6556 14.5556 13.9667 14.3333C14.2778 14.1111 14.6111 14.0278 14.9667 14.0833C15.3222 14.1389 15.6111 14.3222 15.8333 14.6333C16.0778 14.9889 16.3889 15.2611 16.7667 15.45C17.1444 15.6389 17.5556 15.7333 18 15.7333C18.7333 15.7333 19.3611 15.4722 19.8833 14.95C20.4056 14.4278 20.6667 13.8 20.6667 13.0667C20.6667 12.9556 20.6611 12.8444 20.65 12.7333C20.6389 12.6222 20.6111 12.5111 20.5667 12.4C20.1889 12.6222 19.7833 12.7889 19.35 12.9C18.9167 13.0111 18.4667 13.0667 18 13.0667C17.6222 13.0667 17.3056 12.9389 17.05 12.6833C16.7944 12.4278 16.6667 12.1111 16.6667 11.7333C16.6667 11.3556 16.7944 11.0389 17.05 10.7833C17.3056 10.5278 17.6222 10.4 18 10.4C18.7333 10.4 19.3611 10.1389 19.8833 9.61667C20.4056 9.09444 20.6667 8.46667 20.6667 7.73333C20.6667 7 20.4056 6.37778 19.8833 5.86667C19.3611 5.35556 18.7333 5.08889 18 5.06667C17.7556 5.46667 17.4389 5.81667 17.05 6.11667C16.6611 6.41667 16.2333 6.65556 15.7667 6.83333C15.4111 6.96667 15.0667 6.95556 14.7333 6.8C14.4 6.64444 14.1778 6.38889 14.0667 6.03333C13.9556 5.67778 13.9722 5.33333 14.1167 5C14.2611 4.66667 14.5111 4.44444 14.8667 4.33333C15.2 4.22222 15.4722 4.02222 15.6833 3.73333C15.8944 3.44444 16 3.11111 16 2.73333C16 2.25556 15.8333 1.85556 15.5 1.53333C15.1667 1.21111 14.7667 1.05 14.3 1.05C13.8333 1.05 13.4333 1.21111 13.1 1.53333C12.7667 1.85556 12.6 2.25556 12.6 2.73333L12.8333 3.06667ZM10.2667 17.9333V3.06667C10.2667 2.25556 9.99444 1.57222 9.45 1.01667C8.90556 0.461111 8.23333 0.183333 7.43333 0.183333C6.63333 0.183333 5.96111 0.461111 5.41667 1.01667C4.87222 1.57222 4.6 2.25556 4.6 3.06667C4.6 3.42222 4.7 3.75 4.9 4.05C5.1 4.35 5.35 4.57778 5.65 4.73333C6.00556 4.84444 6.26111 5.1 6.41667 5.5C6.57222 5.9 6.58889 6.31111 6.46667 6.73333C6.32222 7.08889 6.08889 7.34444 5.76667 7.5C5.44444 7.65556 5.11111 7.66667 4.76667 7.53333C4.3 7.35556 3.87222 7.11667 3.48333 6.81667C3.09444 6.51667 2.77778 6.16667 2.53333 5.76667C1.87778 5.78889 1.30556 6.06111 0.816667 6.58333C0.327778 7.10556 0.0833333 7.72222 0.0833333 8.43333C0.0833333 9.14444 0.327778 9.76111 0.816667 10.2833C1.30556 10.8056 1.87778 11.0778 2.53333 11.1C2.88889 11.1 3.20556 11.2278 3.48333 11.4833C3.76111 11.7389 3.9 12.0556 3.9 12.4333C3.9 12.8111 3.76111 13.1278 3.48333 13.3833C3.20556 13.6389 2.88889 13.7667 2.53333 13.7667C2.08889 13.7667 1.66111 13.7111 1.25 13.6C0.838889 13.4889 0.461111 13.3222 0.116667 13.1C0.0611111 13.2111 0.0277778 13.3222 0.0166667 13.4333C0.00555556 13.5444 0 13.6556 0 13.7667C0 14.4778 0.244444 15.0944 0.733333 15.6167C1.22222 16.1389 1.8 16.4111 2.46667 16.4333C2.93333 16.4333 3.35556 16.5611 3.73333 16.8167C4.11111 17.0722 4.38889 17.4111 4.56667 17.8333C4.6 18.2111 4.76667 18.5278 5.06667 18.7833C5.36667 19.0389 5.71111 19.1667 6.1 19.1667C6.48889 19.1667 6.83333 19.0389 7.13333 18.7833C7.43333 18.5278 7.6 18.2111 7.63333 17.8333C7.28889 17.6556 6.96667 17.4278 6.66667 17.15C6.36667 16.8722 6.11111 16.5444 5.9 16.1667C5.67778 15.8556 5.59444 15.5222 5.65 15.1667C5.70556 14.8111 5.88889 14.5222 6.2 14.3C6.51111 14.0778 6.84444 13.9944 7.2 14.05C7.55556 14.1056 7.84444 14.2889 8.06667 14.6C8.31111 14.9556 8.62222 15.2278 9 15.4167C9.37778 15.6056 9.78889 15.7 10.2333 15.7C10.9667 15.7 11.5944 15.4389 12.1167 14.9167C12.6389 14.3944 12.9 13.7667 12.9 13.0333C12.9 12.9222 12.8944 12.8111 12.8833 12.7C12.8722 12.5889 12.8444 12.4778 12.8 12.3667C12.4222 12.5889 12.0167 12.7556 11.5833 12.8667C11.15 12.9778 10.7 13.0333 10.2333 13.0333C9.85556 13.0333 9.53889 12.9056 9.28333 12.65C9.02778 12.3944 8.9 12.0778 8.9 11.7C8.9 11.3222 9.02778 11.0056 9.28333 10.75C9.53889 10.4944 9.85556 10.3667 10.2333 10.3667C10.9667 10.3667 11.5944 10.1056 12.1167 9.58333C12.6389 9.06111 12.9 8.43333 12.9 7.7C12.9 6.96667 12.6389 6.33889 12.1167 5.81667C11.5944 5.29444 10.9667 5.03333 10.2333 5.03333C9.97778 5.43333 9.65556 5.78333 9.26667 6.08333C8.87778 6.38333 8.45 6.62222 7.98333 6.8C7.62778 6.93333 7.28333 6.92222 6.95 6.76667C6.61667 6.61111 6.39444 6.35556 6.28333 6C6.17222 5.64444 6.18889 5.3 6.33333 4.96667C6.47778 4.63333 6.72778 4.41111 7.08333 4.3C7.41667 4.18889 7.68889 3.98889 7.9 3.7C8.11111 3.41111 8.21667 3.07778 8.21667 2.7C8.21667 2.22222 8.05 1.82222 7.71667 1.5C7.38333 1.17778 6.98333 1.01667 6.51667 1.01667C6.05 1.01667 5.65 1.17778 5.31667 1.5C4.98333 1.82222 4.81667 2.22222 4.81667 2.7L10.2667 17.9333Z"
            fill="currentColor"
          />
        </svg>
      ),
    },
    {
      label: 'Articles',
      path: '/news-publications',
      icon: (
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M4 22C3.45 22 2.97917 21.8042 2.5875 21.4125C2.19583 21.0208 2 20.55 2 20V4C2 3.45 2.19583 2.97917 2.5875 2.5875C2.97917 2.19583 3.45 2 4 2H20C20.55 2 21.0208 2.19583 21.4125 2.5875C21.8042 2.97917 22 3.45 22 4V20C22 20.55 21.8042 21.0208 21.4125 21.4125C21.0208 21.8042 20.55 22 20 22H4ZM4 20H20V4H4V20ZM6 18H18C18.2833 18 18.5208 17.9042 18.7125 17.7125C18.9042 17.5208 19 17.2833 19 17C19 16.7167 18.9042 16.4792 18.7125 16.2875C18.5208 16.0958 18.2833 16 18 16H6C5.71667 16 5.47917 16.0958 5.2875 16.2875C5.09583 16.4792 5 16.7167 5 17C5 17.2833 5.09583 17.5208 5.2875 17.7125C5.47917 17.9042 5.71667 18 6 18ZM6 14H9C9.28333 14 9.52083 13.9042 9.7125 13.7125C9.90417 13.5208 10 13.2833 10 13V7C10 6.71667 9.90417 6.47917 9.7125 6.2875C9.52083 6.09583 9.28333 6 9 6H6C5.71667 6 5.47917 6.09583 5.2875 6.2875C5.09583 6.47917 5 6.71667 5 7V13C5 13.2833 5.09583 13.5208 5.2875 13.7125C5.47917 13.9042 5.71667 14 6 14ZM13 14H18C18.2833 14 18.5208 13.9042 18.7125 13.7125C18.9042 13.5208 19 13.2833 19 13C19 12.7167 18.9042 12.4792 18.7125 12.2875C18.5208 12.0958 18.2833 12 18 12H13C12.7167 12 12.4792 12.0958 12.2875 12.2875C12.0958 12.4792 12 12.7167 12 13C12 13.2833 12.0958 13.5208 12.2875 13.7125C12.4792 13.9042 12.7167 14 13 14ZM13 10H18C18.2833 10 18.5208 9.90417 18.7125 9.7125C18.9042 9.52083 19 9.28333 19 9C19 8.71667 18.9042 8.47917 18.7125 8.2875C18.5208 8.09583 18.2833 8 18 8H13C12.7167 8 12.4792 8.09583 12.2875 8.2875C12.0958 8.47917 12 8.71667 12 9C12 9.28333 12.0958 9.52083 12.2875 9.7125C12.4792 9.90417 12.7167 10 13 10Z"
            fill="currentColor"
          />
        </svg>
      ),
    },
    {
      label: 'Network',
      path: '/network',
      hasNotification: true,
      notificationCount: 3,
      icon: (
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M4.2 24C3.04 24 2.05 23.595 1.23 22.785C0.41 21.975 0 20.98 0 19.8C0 18.64 0.41 17.65 1.23 16.83C2.05 16.01 3.04 15.6 4.2 15.6C4.56 15.6 4.91 15.645 5.25 15.735C5.59 15.825 5.91 15.95 6.21 16.11L10.8 11.52V8.22C9.92 7.96 9.2 7.465 8.64 6.735C8.08 6.005 7.8 5.16 7.8 4.2C7.8 3.04 8.21 2.05 9.03 1.23C9.85 0.41 10.84 0 12 0C13.16 0 14.15 0.41 14.97 1.23C15.79 2.05 16.2 3.04 16.2 4.2C16.2 5.16 15.92 6.005 15.36 6.735C14.8 7.465 14.08 7.96 13.2 8.22V11.52L17.82 16.11C18.12 15.95 18.435 15.825 18.765 15.735C19.095 15.645 19.44 15.6 19.8 15.6C20.96 15.6 21.95 16.01 22.77 16.83C23.59 17.65 24 18.64 24 19.8C24 20.96 23.59 21.95 22.77 22.77C21.95 23.59 20.96 24 19.8 24C18.64 24 17.65 23.59 16.83 22.77C16.01 21.95 15.6 20.96 15.6 19.8C15.6 19.44 15.645 19.09 15.735 18.75C15.825 18.41 15.95 18.09 16.11 17.79L12 13.68L7.89 17.79C8.05 18.09 8.175 18.41 8.265 18.75C8.355 19.09 8.4 19.44 8.4 19.8C8.4 20.96 7.99 21.95 7.17 22.77C6.35 23.59 5.36 24 4.2 24ZM19.8 21.6C20.3 21.6 20.725 21.425 21.075 21.075C21.425 20.725 21.6 20.3 21.6 19.8C21.6 19.3 21.425 18.875 21.075 18.525C20.725 18.175 20.3 18 19.8 18C19.3 18 18.875 18.175 18.525 18.525C18.175 18.875 18 19.3 18 19.8C18 20.3 18.175 20.725 18.525 21.075C18.875 21.425 19.3 21.6 19.8 21.6ZM12 6C12.5 6 12.925 5.825 13.275 5.475C13.625 5.125 13.8 4.7 13.8 4.2C13.8 3.7 13.625 3.275 13.275 2.925C12.925 2.575 12.5 2.4 12 2.4C11.5 2.4 11.075 2.575 10.725 2.925C10.375 3.275 10.2 3.7 10.2 4.2C10.2 4.7 10.375 5.125 10.725 5.475C11.075 5.825 11.5 6 12 6ZM4.2 21.6C4.7 21.6 5.125 21.425 5.475 21.075C5.825 20.725 6 20.3 6 19.8C6 19.3 5.825 18.875 5.475 18.525C5.125 18.175 4.7 18 4.2 18C3.7 18 3.275 18.175 2.925 18.525C2.575 18.875 2.4 19.3 2.4 19.8C2.4 20.3 2.575 20.725 2.925 21.075C3.275 21.425 3.7 21.6 4.2 21.6Z"
            fill="currentColor"
          />
        </svg>
      ),
    },
    {
      label: 'Events',
      path: '/events',
      hasNotification: true,
      notificationCount: 5,
      icon: (
        <svg
          width="22"
          height="24"
          viewBox="0 0 22 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M13.8 19.2C12.96 19.2 12.25 18.91 11.67 18.33C11.09 17.75 10.8 17.04 10.8 16.2C10.8 15.36 11.09 14.65 11.67 14.07C12.25 13.49 12.96 13.2 13.8 13.2C14.64 13.2 15.35 13.49 15.93 14.07C16.51 14.65 16.8 15.36 16.8 16.2C16.8 17.04 16.51 17.75 15.93 18.33C15.35 18.91 14.64 19.2 13.8 19.2ZM2.4 24C1.74 24 1.175 23.765 0.705 23.295C0.235 22.825 0 22.26 0 21.6V4.8C0 4.14 0.235 3.575 0.705 3.105C1.175 2.635 1.74 2.4 2.4 2.4H3.6V1.2C3.6 0.86 3.715 0.575 3.945 0.345C4.175 0.115 4.46 0 4.8 0C5.14 0 5.425 0.115 5.655 0.345C5.885 0.575 6 0.86 6 1.2V2.4H15.6V1.2C15.6 0.86 15.715 0.575 15.945 0.345C16.175 0.115 16.46 0 16.8 0C17.14 0 17.425 0.115 17.655 0.345C17.885 0.575 18 0.86 18 1.2V2.4H19.2C19.86 2.4 20.425 2.635 20.895 3.105C21.365 3.575 21.6 4.14 21.6 4.8V21.6C21.6 22.26 21.365 22.825 20.895 23.295C20.425 23.765 19.86 24 19.2 24H2.4ZM2.4 21.6H19.2V9.6H2.4V21.6ZM2.4 7.2H19.2V4.8H2.4V7.2Z"
            fill="currentColor"
          />
        </svg>
      ),
    },
  ];

  const footerItems = items.length > 0 ? items : defaultItems;

  return (
    <nav
      className={cn(
        'lg:hidden fixed bottom-0 left-0 right-0 z-50',
        'bg-[#6B4E3D] border-t border-[#8B6941]',
        'shadow-[0_-2px_10px_rgba(0,0,0,0.1)]',
        className
      )}
      style={{
        paddingBottom: 'env(safe-area-inset-bottom)',
      }}
    >
      <div className="flex items-center justify-around px-2 py-2 sm:px-4 sm:py-3">
        {footerItems.map((item, idx) => {
          const itemIsActive = isActive(item.path);
          return (
            <Link
              key={idx}
              href={item.path}
              className={cn(
                'flex flex-col items-center gap-1 px-2 py-2 sm:px-3 rounded-lg min-w-[60px]',
                'transition-colors duration-200',
                itemIsActive ? 'bg-[#8B6941]/30' : 'active:bg-[#8B6941]/20'
              )}
            >
              <div className="relative">
                <div className={cn(itemIsActive ? 'text-white' : 'text-white/70')}>{item.icon}</div>
                {item.hasNotification && item.notificationCount && (
                  <div className="absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 bg-[#D32F2F] rounded-full flex items-center justify-center">
                    <span className="text-white text-[10px] font-bold leading-none">
                      {item.notificationCount}
                    </span>
                  </div>
                )}
              </div>
              <span
                className={cn('text-xs font-medium', itemIsActive ? 'text-white' : 'text-white/70')}
              >
                {item.label}
              </span>
            </Link>
          );
        })}
      </div>
    </nav>
  );
}
 